# PipeWire override: de-prioritize Dummy-Driver and Freewheel-Driver.
#
# These support drivers are useful for always-process/JACK/freewheel cases,
# but on a dedicated realtime setup they can end up clocking the graph from
# the system monotonic clock and cause "slow" scheduling.
#
# Install:
#   mkdir -p ~/.config/pipewire/pipewire.conf.d
#   cp scripts/pipewire_derank_dummy_freewheel.conf ~/.config/pipewire/pipewire.conf.d/60-derank-dummy-freewheel.conf
#   systemctl --user restart pipewire wireplumber
#
# This drop-in *adds* objects; to ensure it wins, we set priorities extremely low.
# If you still see 20000/19000 on the original nodes, you may need to disable the
# original objects in your main pipewire.conf (not recommended) or override by
# copying pipewire.conf and editing context.objects.

context.objects = [
  { factory = spa-node-factory
      args = {
          factory.name    = support.node.driver
          node.name       = Dummy-Driver
          node.group      = pipewire.dummy
          priority.driver = 1
      }
  }
  { factory = spa-node-factory
      args = {
          factory.name    = support.node.driver
          node.name       = Freewheel-Driver
          node.group      = pipewire.freewheel
          node.freewheel  = true
          priority.driver = 1
      }
  }
]
